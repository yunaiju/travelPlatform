<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="í‹ˆìƒˆ - AI ì—¬í–‰ ì¶”ì²œ">
    <title>AI ì—¬í–‰ ì¶”ì²œ | í‹ˆìƒˆ</title>

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml"
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸŒ¿</text></svg>">

    <!-- Stylesheets -->
    <link rel="stylesheet" href="css/reset.css">
    <link rel="stylesheet" href="css/variables.css">
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/animations.css">
    <link rel="stylesheet" href="css/pages.css">

    <style>
        .recommend-page {
            min-height: 100vh;
            padding-top: 80px;
            background: var(--color-light);
        }

        .recommend-header {
            text-align: center;
            padding: var(--space-12) 0;
        }

        .recommend-header__title {
            font-family: var(--font-serif);
            font-size: var(--text-4xl);
            color: var(--color-dark);
            margin-bottom: var(--space-3);
        }

        .recommend-header__title span {
            background: linear-gradient(135deg, var(--color-primary), var(--color-accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .recommend-header__subtitle {
            font-size: var(--text-lg);
            color: var(--color-gray);
        }

        /* Tabs */
        .recommend-tabs {
            display: flex;
            justify-content: center;
            gap: var(--space-2);
            margin-bottom: var(--space-10);
        }

        .recommend-tab {
            padding: var(--space-4) var(--space-8);
            font-size: var(--text-base);
            font-weight: var(--font-semibold);
            color: var(--color-gray);
            background: var(--color-white);
            border: 2px solid var(--color-secondary);
            border-radius: var(--radius-full);
            cursor: pointer;
            transition: all var(--transition-fast);
        }

        .recommend-tab:hover {
            border-color: var(--color-primary);
            color: var(--color-primary);
        }

        .recommend-tab.active {
            background: var(--color-primary);
            border-color: var(--color-primary);
            color: var(--color-white);
        }

        /* Tab Content */
        .tab-content {
            display: none;
            animation: fadeIn 0.4s ease;
        }

        .tab-content.active {
            display: block;
        }

        /* Survey Section */
        .survey-container {
            max-width: 700px;
            margin: 0 auto;
            background: var(--color-white);
            border-radius: var(--radius-2xl);
            padding: var(--space-10);
            box-shadow: var(--shadow-lg);
        }

        .survey-progress {
            display: flex;
            justify-content: center;
            gap: var(--space-2);
            margin-bottom: var(--space-8);
        }

        .survey-progress__dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--color-secondary);
            transition: all var(--transition-fast);
        }

        .survey-progress__dot.active {
            background: var(--color-primary);
            transform: scale(1.2);
        }

        .survey-progress__dot.completed {
            background: var(--color-accent);
        }

        .survey-question {
            display: none;
            text-align: center;
            animation: fadeInUp 0.4s ease;
        }

        .survey-question.active {
            display: block;
        }

        .survey-question__number {
            font-size: var(--text-sm);
            color: var(--color-accent);
            font-weight: var(--font-semibold);
            margin-bottom: var(--space-3);
        }

        .survey-question__text {
            font-size: var(--text-2xl);
            font-weight: var(--font-bold);
            color: var(--color-dark);
            margin-bottom: var(--space-8);
            line-height: 1.4;
        }

        .survey-options {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: var(--space-3);
            margin-bottom: var(--space-8);
        }

        .survey-option {
            padding: var(--space-4) var(--space-6);
            font-size: var(--text-base);
            color: var(--color-dark);
            background: var(--color-secondary-light);
            border: 2px solid transparent;
            border-radius: var(--radius-xl);
            cursor: pointer;
            transition: all var(--transition-fast);
        }

        .survey-option:hover {
            border-color: var(--color-primary);
            background: var(--color-white);
        }

        .survey-option.selected {
            background: var(--color-primary);
            color: var(--color-white);
            border-color: var(--color-primary);
        }

        .survey-nav {
            display: flex;
            justify-content: space-between;
            margin-top: var(--space-6);
        }

        /* Chat Section */
        .chat-container {
            max-width: 800px;
            margin: 0 auto;
            background: var(--color-white);
            border-radius: var(--radius-2xl);
            overflow: hidden;
            box-shadow: var(--shadow-lg);
        }

        .chat-messages {
            height: 450px;
            overflow-y: auto;
            padding: var(--space-6);
            display: flex;
            flex-direction: column;
            gap: var(--space-4);
        }

        .chat-message {
            max-width: 80%;
            padding: var(--space-4) var(--space-5);
            border-radius: var(--radius-xl);
            animation: fadeInUp 0.3s ease;
        }

        .chat-message--ai {
            align-self: flex-start;
            background: var(--color-secondary-light);
            color: var(--color-dark);
            border-bottom-left-radius: var(--radius-sm);
        }

        .chat-message--user {
            align-self: flex-end;
            background: var(--color-primary);
            color: var(--color-white);
            border-bottom-right-radius: var(--radius-sm);
        }

        .chat-message__sender {
            font-size: var(--text-xs);
            font-weight: var(--font-semibold);
            margin-bottom: var(--space-1);
            opacity: 0.7;
        }

        .chat-message__text {
            font-size: var(--text-base);
            line-height: 1.6;
        }

        .chat-input-area {
            display: flex;
            gap: var(--space-3);
            padding: var(--space-4) var(--space-6);
            border-top: 1px solid var(--color-secondary);
            background: var(--color-light);
        }

        .chat-input {
            flex: 1;
            padding: var(--space-4);
            border: 2px solid var(--color-secondary);
            border-radius: var(--radius-xl);
            font-size: var(--text-base);
            resize: none;
            transition: border-color var(--transition-fast);
        }

        .chat-input:focus {
            outline: none;
            border-color: var(--color-primary);
        }

        .chat-send-btn {
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--color-primary);
            color: var(--color-white);
            border-radius: var(--radius-full);
            transition: all var(--transition-fast);
        }

        .chat-send-btn:hover {
            background: var(--color-primary-light);
            transform: scale(1.05);
        }

        .chat-send-btn:disabled {
            background: var(--color-gray-light);
            cursor: not-allowed;
        }

        /* Results Section */
        .results-container {
            max-width: 900px;
            margin: 0 auto;
        }

        .results-header {
            text-align: center;
            margin-bottom: var(--space-8);
        }

        .results-header__title {
            font-size: var(--text-2xl);
            font-weight: var(--font-bold);
            color: var(--color-dark);
            margin-bottom: var(--space-2);
        }

        .results-header__subtitle {
            color: var(--color-gray);
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: var(--space-6);
        }

        .typing-indicator {
            display: flex;
            gap: 4px;
            padding: var(--space-4);
        }

        .typing-indicator span {
            width: 8px;
            height: 8px;
            background: var(--color-gray-light);
            border-radius: 50%;
            animation: bounce 1.4s infinite ease-in-out;
        }

        .typing-indicator span:nth-child(1) {
            animation-delay: -0.32s;
        }

        .typing-indicator span:nth-child(2) {
            animation-delay: -0.16s;
        }

        .typing-indicator span:nth-child(3) {
            animation-delay: 0s;
        }

        .recommended-card {
            background: var(--color-white);
            border-radius: var(--radius-xl);
            overflow: hidden;
            box-shadow: var(--shadow-md);
            transition: all var(--transition-base);
        }

        .recommended-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-xl);
        }

        .recommended-card__image {
            height: 160px;
            overflow: hidden;
        }

        .recommended-card__image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .recommended-card__content {
            padding: var(--space-4);
        }

        .recommended-card__title {
            font-weight: var(--font-bold);
            margin-bottom: var(--space-2);
        }

        .recommended-card__reason {
            font-size: var(--text-sm);
            color: var(--color-gray);
            margin-bottom: var(--space-3);
        }

        .recommended-card__actions {
            display: flex;
            gap: var(--space-2);
        }

        @media (max-width: 768px) {

            .survey-container,
            .chat-container {
                margin: 0 var(--space-4);
            }

            .recommend-tabs {
                flex-direction: column;
                align-items: center;
            }

            .recommend-tab {
                width: 200px;
                text-align: center;
            }
        }
    </style>
</head>

<body>
    <!-- Header -->
    <header class="header scrolled">
        <div class="container">
            <div class="header__inner">
                <a href="main.html" class="header__logo">í‹ˆìƒˆ</a>
                <nav class="header__nav">
                    <a href="main.html#places" class="header__link hover-underline">ì¥ì†Œ íƒìƒ‰</a>
                    <a href="recommend.html" class="header__link hover-underline"
                        style="color: var(--color-primary);">AI ì¶”ì²œ</a>
                    <a href="planner.html" class="header__link hover-underline">ì—¬í–‰ ê³„íš</a>
                </nav>
                <a href="planner.html" class="btn btn-primary btn-sm">ë‚´ ì¼ì • ë³´ê¸°</a>
            </div>
        </div>
    </header>

    <!-- Recommend Page -->
    <main class="recommend-page">
        <div class="container">
            <!-- Header -->
            <div class="recommend-header reveal">
                <h1 class="recommend-header__title">
                    <span>AI</span>ê°€ ì¶”ì²œí•˜ëŠ” ë‚˜ë§Œì˜ ì—¬í–‰
                </h1>
                <p class="recommend-header__subtitle">
                    ì„¤ë¬¸ì— ë‹µí•˜ê±°ë‚˜ ì›í•˜ëŠ” ë‚´ìš©ì„ ì…ë ¥í•˜ë©´ ë”± ë§ëŠ” ì¥ì†Œë¥¼ ì¶”ì²œí•´ë“œë ¤ìš”
                </p>
            </div>

            <!-- Tabs -->
            <div class="recommend-tabs reveal">
                <button class="recommend-tab active" data-tab="survey">
                    ğŸ“‹ ë¹ ë¥¸ ì„¤ë¬¸ ì‹œì‘í•˜ê¸°
                </button>
                <button class="recommend-tab" data-tab="chat">
                    ğŸ’¬ AI í”Œë˜ë„ˆì™€ ëŒ€í™”í•˜ê¸°
                </button>
            </div>

            <!-- Survey Tab -->
            <div class="tab-content active" id="tab-survey">
                <div class="survey-container">
                    <div class="survey-progress" id="survey-progress">
                        <div class="survey-progress__dot active"></div>
                        <div class="survey-progress__dot"></div>
                        <div class="survey-progress__dot"></div>
                        <div class="survey-progress__dot"></div>
                        <div class="survey-progress__dot"></div>
                    </div>

                    <!-- Question 1 -->
                    <div class="survey-question active" data-question="1">
                        <div class="survey-question__number">ì§ˆë¬¸ 1/5</div>
                        <h2 class="survey-question__text">ì˜¤ëŠ˜ ì–´ë–¤ ê¸°ë¶„ì´ì„¸ìš”?</h2>
                        <div class="survey-options">
                            <button class="survey-option" data-value="íë§">ğŸ§˜ íë§ì´ í•„ìš”í•´ìš”</button>
                            <button class="survey-option" data-value="í™œë™ì ">ğŸƒ í™œë™ì ì´ê³  ì‹¶ì–´ìš”</button>
                            <button class="survey-option" data-value="ê°ì„±">ğŸ’« ê°ì„±ì ì¸ ì‹œê°„ì„ ë³´ë‚´ê³  ì‹¶ì–´ìš”</button>
                            <button class="survey-option" data-value="íƒí—˜">ğŸ—ºï¸ ìƒˆë¡œìš´ ê³³ì„ íƒí—˜í•˜ê³  ì‹¶ì–´ìš”</button>
                        </div>
                    </div>

                    <!-- Question 2 -->
                    <div class="survey-question" data-question="2">
                        <div class="survey-question__number">ì§ˆë¬¸ 2/5</div>
                        <h2 class="survey-question__text">ì„ í˜¸í•˜ëŠ” ë¶„ìœ„ê¸°ëŠ”?</h2>
                        <div class="survey-options">
                            <button class="survey-option" data-value="ì¡°ìš©í•œ">ğŸ¤« ì¡°ìš©í•˜ê³  í•œì í•œ</button>
                            <button class="survey-option" data-value="ìì—°">ğŸŒ² ìì—° ì†ì—ì„œ</button>
                            <button class="survey-option" data-value="ë„ì‹œ">ğŸ™ï¸ ë„ì‹¬ ì† ê°ì„±</button>
                            <button class="survey-option" data-value="ì—­ì‚¬">ğŸ›ï¸ ì—­ì‚¬ì™€ ë¬¸í™”ê°€ ìˆëŠ”</button>
                        </div>
                    </div>

                    <!-- Question 3 -->
                    <div class="survey-question" data-question="3">
                        <div class="survey-question__number">ì§ˆë¬¸ 3/5</div>
                         <h2 class="survey-question__text">ëˆ„êµ¬ì™€ í•¨ê»˜í•˜ì‹œë‚˜ìš”?</h2>
                        <div class="survey-options">
                            <button class="survey-option" data-value="í˜¼ì">ğŸ§‘ í˜¼ì</button>
                            <button class="survey-option" data-value="ì—°ì¸">ğŸ’‘ ì—°ì¸ê³¼</button>
                            <button class="survey-option" data-value="ì¹œêµ¬">ğŸ‘« ì¹œêµ¬ì™€</button>
                            <button class="survey-option" data-value="ê°€ì¡±">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ ê°€ì¡±ê³¼</button>
                        </div>
                    </div>

                    <!-- Question 4 -->
                    <div class="survey-question" data-question="4">
                        <div class="survey-question__number">ì§ˆë¬¸ 4/5</div>
                        <h2 class="survey-question__text">ì˜ˆì‚°ì€ ì–´ëŠì •ë„ì¸ê°€ìš”?</h2>
                        <div class="survey-options">
                            <button class="survey-option" data-value="5">ğŸ’µ 5ë§Œì› ì´í•˜</button>
                            <button class="survey-option" data-value="10">ğŸ’µ 10ë§Œì› ì´í•˜</button>
                            <button class="survey-option" data-value="15">ğŸ’µ 15ë§Œì› ì´í•˜</button>
                            <button class="survey-option" data-value="20">ğŸ’µ 20ë§Œì› ì´í•˜</button>
                            <button class="survey-option" data-value="0">ğŸ’µ ìƒê´€ ì—†ìŒ</button>
                        </div>
                    </div>

                    <!-- Question 5 -->
                    <div class="survey-question" data-question="5">
                        <div class="survey-question__number">ì§ˆë¬¸ 5/5</div>
                        <h2 class="survey-question__text">ê°€ì¥ ì›í•˜ëŠ” ê²ƒì€?</h2>
                        <div class="survey-options">
                            <button class="survey-option" data-value="ì‚¬ì§„">ğŸ“¸ ì¸ìƒìƒ· ë‚¨ê¸°ê¸°</button>
                            <button class="survey-option" data-value="íœ´ì‹">â˜• ì—¬ìœ ë¡œìš´ íœ´ì‹</button>
                            <button class="survey-option" data-value="ì‚°ì±…">ğŸš¶ ì‚°ì±…í•˜ë©° ìƒê° ì •ë¦¬</button>
                            <button class="survey-option" data-value="ë°ì´íŠ¸">â¤ï¸ íŠ¹ë³„í•œ ë°ì´íŠ¸</button>
                            <button class="survey-option" data-value="ì·¨í–¥">âœ¨ ì˜ê°ê³¼ ì·¨í–¥ ì°¾ê¸°</button>
                        </div>
                    </div>

                    <div class="survey-nav">
                        <button class="btn btn-glass" id="survey-prev" style="visibility: hidden;">
                            â† ì´ì „
                        </button>
                        <button class="btn btn-primary" id="survey-next" disabled>
                            ë‹¤ìŒ â†’
                        </button>
                    </div>
                </div>
            </div>

            <!-- Chat Tab -->
            <div class="tab-content" id="tab-chat">
                <div class="chat-container">
                    <div class="chat-messages" id="chat-messages">
                        <div class="chat-message chat-message--ai">
                            <div class="chat-message__sender">í‹ˆìƒˆ AI</div>
                            <div class="chat-message__text">
                                ì•ˆë…•í•˜ì„¸ìš”! ì €ëŠ” í‹ˆìƒˆ AI í”Œë˜ë„ˆìš” ğŸŒ¿<br><br>
                                ì–´ë–¤ ì—¬í–‰ì„ ì›í•˜ì‹œëŠ”ì§€ ììœ ë¡­ê²Œ ë§ì”€í•´ì£¼ì„¸ìš”.<br>
                                ì˜ˆ: "í˜¼ì ì¡°ìš©íˆ ì‚°ì±…í•  ìˆ˜ ìˆëŠ” ê³³", "ì—°ì¸ê³¼ ì•¼ê²½ ë³¼ ìˆ˜ ìˆëŠ” ê³³", "ì‚¬ì§„ ì°ê¸° ì¢‹ì€ ê°ì„± ì¥ì†Œ" ë“±
                            </div>
                        </div>
                    </div>
                    <div class="chat-input-area">
                        <textarea class="chat-input" id="chat-input" placeholder="ì›í•˜ëŠ” ì—¬í–‰ ìŠ¤íƒ€ì¼ì„ ììœ ë¡­ê²Œ ì…ë ¥í•˜ì„¸ìš”."
                            rows="1"></textarea>
                        <button class="chat-send-btn" id="chat-send">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <line x1="22" y1="2" x2="11" y2="13" />
                                <polygon points="22 2 15 22 11 13 2 9 22 2" />
                            </svg>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Results Section (Hidden initially) -->
            <div id="results-section" style="display: none; margin-top: var(--space-12);">
                <div class="results-container">
                    <div class="results-header">
                        <h2 class="results-header__title" id="results-title">ğŸŒ¿ ì¶”ì²œ ê²°ê³¼</h2>
                        <p class="results-header__subtitle" id="results-subtitle">ë‹¹ì‹ ì—ê²Œ ë”± ë§ëŠ” ì¥ì†Œë“¤ì´ì—ìš”</p>
                    </div>
                    <div class="results-grid" id="results-grid">
                        <!-- Results will be rendered here -->
                    </div>
                    <div style="text-align: center; margin-top: var(--space-8);">
                        <button class="btn btn-primary btn-lg" onclick="addAllToPlan()">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <path d="M12 5v14M5 12h14" />
                            </svg>
                            ëª¨ë“  ì¥ì†Œ ì¼ì •ì— ì¶”ê°€
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Scripts -->
    <script src="js/data.js"></script>
    <script>
        // Survey State
        let currentQuestion = 1;
        const totalQuestions = 5;
        const surveyAnswers = {};

        // DOM Elements
        const tabs = document.querySelectorAll('.recommend-tab');
        const tabContents = document.querySelectorAll('.tab-content');
        const surveyQuestions = document.querySelectorAll('.survey-question');
        const progressDots = document.querySelectorAll('.survey-progress__dot');
        const prevBtn = document.getElementById('survey-prev');
        const nextBtn = document.getElementById('survey-next');
        const chatMessages = document.getElementById('chat-messages');
        const chatInput = document.getElementById('chat-input');
        const chatSendBtn = document.getElementById('chat-send');

        // Tab Switching
        tabs.forEach(tab => {
            tab.addEventListener('click', () => {
                tabs.forEach(t => t.classList.remove('active'));
                tab.classList.add('active');

                tabContents.forEach(content => content.classList.remove('active'));
                document.getElementById(`tab-${tab.dataset.tab}`).classList.add('active');
            });
        });

        // Survey Option Selection
        document.querySelectorAll('.survey-option').forEach(option => {
            option.addEventListener('click', () => {
                const question = option.closest('.survey-question');
                question.querySelectorAll('.survey-option').forEach(o => o.classList.remove('selected'));
                option.classList.add('selected');
                surveyAnswers[currentQuestion] = option.dataset.value;
                nextBtn.disabled = false;
            });
        });

        // Survey Navigation
        nextBtn.addEventListener('click', () => {
            if (currentQuestion < totalQuestions) {
                goToQuestion(currentQuestion + 1);
            } else {
                // Show results
                generateSurveyResults();
            }
        });

        prevBtn.addEventListener('click', () => {
            if (currentQuestion > 1) {
                goToQuestion(currentQuestion - 1);
            }
        });

        function goToQuestion(num) {
            surveyQuestions.forEach(q => q.classList.remove('active'));
            document.querySelector(`[data-question="${num}"]`).classList.add('active');

            progressDots.forEach((dot, i) => {
                dot.classList.remove('active');
                if (i < num - 1) dot.classList.add('completed');
                else dot.classList.remove('completed');
                if (i === num - 1) dot.classList.add('active');
            });

            currentQuestion = num;

            prevBtn.style.visibility = num > 1 ? 'visible' : 'hidden';
            nextBtn.textContent = num === totalQuestions ? 'ê²°ê³¼ ë³´ê¸° â†’' : 'ë‹¤ìŒ â†’';
            nextBtn.disabled = !surveyAnswers[num];
        }

        // Generate Survey Results
        function generateSurveyResults() {
            const answers = Object.values(surveyAnswers);
            let recommendedPlaces = [];

            // Simple matching algorithm
            placesData.forEach(place => {
                let score = 0;

                // Match based on answers
                if (answers.includes('íë§') && (place.tags.includes('íë§') || place.category === 'ìì—°')) score += 2;
                if (answers.includes('ê°ì„±') && (place.tags.includes('ê°ì„±') || place.category === 'ê°ì„±')) score += 2;
                if (answers.includes('ì¡°ìš©í•œ') && place.congestion === 'quiet') score += 3;
                if (answers.includes('ìì—°') && place.category === 'ìì—°') score += 2;
                if (answers.includes('ì—­ì‚¬') && place.category === 'ì—­ì‚¬') score += 2;
                if (answers.includes('ë°¤') && (place.category === 'ì•¼ê²½' || place.tags.includes('ì•¼ê²½'))) score += 3;
                if (answers.includes('ì‚¬ì§„') && place.tags.includes('ì‚¬ì§„')) score += 2;
                if (answers.includes('ì‚°ì±…') && (place.category === 'ì‚°ì±…' || place.tags.includes('ì‚°ì±…'))) score += 2;
                if (answers.includes('í˜¼ì') && place.congestion === 'quiet') score += 1;
                if (answers.includes('ì—°ì¸') && (place.tags.includes('ê°ì„±') || place.category === 'ì•¼ê²½')) score += 1;

                if (score > 0) {
                    recommendedPlaces.push({ ...place, score });
                }
            });

            // Sort by score and take top 4
            recommendedPlaces.sort((a, b) => b.score - a.score);
            recommendedPlaces = recommendedPlaces.slice(0, 4);

            showResults(recommendedPlaces, 'ì„¤ë¬¸ ì‘ë‹µì„ ë¶„ì„í–ˆì–´ìš”');
        }

        // Chat functionality
        chatSendBtn.addEventListener('click', sendMessage);
        chatInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendMessage();
            }
        });

        function sendMessage() {
            const message = chatInput.value.trim();
            if (!message) return;

            // Add user message
            addChatMessage(message, 'user');
            chatInput.value = '';

            // Show typing indicator
            const typingDiv = document.createElement('div');
            typingDiv.className = 'chat-message chat-message--ai';
            typingDiv.innerHTML = `
        <div class="chat-message__sender">í‹ˆìƒˆ AI</div>
        <div class="typing-indicator">
          <span></span><span></span><span></span>
        </div>
      `;
            chatMessages.appendChild(typingDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;

            // Simulate AI response
            setTimeout(() => {
                typingDiv.remove();
                processUserMessage(message);
            }, 1500);
        }

        function addChatMessage(text, type) {
            const div = document.createElement('div');
            div.className = `chat-message chat-message--${type}`;
            div.innerHTML = `
        <div class="chat-message__sender">${type === 'ai' ? 'í‹ˆìƒˆ AI' : 'ë‚˜'}</div>
        <div class="chat-message__text">${text}</div>
      `;
            chatMessages.appendChild(div);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function processUserMessage(message) {
            const lowerMessage = message.toLowerCase();
            let recommendedPlaces = [];

            // Keyword matching
            placesData.forEach(place => {
                let score = 0;

                // Check for keywords
                if (lowerMessage.includes('ì¡°ìš©') || lowerMessage.includes('í•œì ')) {
                    if (place.congestion === 'quiet') score += 3;
                }
                if (lowerMessage.includes('ì‚°ì±…')) {
                    if (place.category === 'ì‚°ì±…' || place.tags.includes('ì‚°ì±…')) score += 2;
                }
                if (lowerMessage.includes('ì•¼ê²½') || lowerMessage.includes('ë°¤')) {
                    if (place.category === 'ì•¼ê²½' || place.tags.includes('ì•¼ê²½')) score += 3;
                }
                if (lowerMessage.includes('ìì—°') || lowerMessage.includes('ê³µì›')) {
                    if (place.category === 'ìì—°') score += 2;
                }
                if (lowerMessage.includes('ê°ì„±') || lowerMessage.includes('ì˜ˆìœ')) {
                    if (place.category === 'ê°ì„±' || place.tags.includes('ê°ì„±')) score += 2;
                }
                if (lowerMessage.includes('ì‚¬ì§„') || lowerMessage.includes('ì¸ìƒìƒ·')) {
                    if (place.tags.includes('ì‚¬ì§„')) score += 2;
                }
                if (lowerMessage.includes('í˜¼ì')) {
                    if (place.congestion === 'quiet') score += 2;
                }
                if (lowerMessage.includes('ì—°ì¸') || lowerMessage.includes('ë°ì´íŠ¸')) {
                    if (place.category === 'ì•¼ê²½' || place.category === 'ê°ì„±') score += 2;
                }
                if (lowerMessage.includes('ì—­ì‚¬') || lowerMessage.includes('ê³ ê¶')) {
                    if (place.category === 'ì—­ì‚¬') score += 3;
                }
                if (lowerMessage.includes('íë§') || lowerMessage.includes('íœ´ì‹')) {
                    if (place.tags.includes('íë§') || place.category === 'ìì—°') score += 2;
                }
                if (lowerMessage.includes('ì¹´í˜')) {
                    if (place.category === 'ì¹´í˜') score += 3;
                }
                if (lowerMessage.includes('ë¬¸í™”') || lowerMessage.includes('ì˜ˆìˆ ')) {
                    if (place.category === 'ë¬¸í™”') score += 3;
                }

                if (score > 0) {
                    recommendedPlaces.push({ ...place, score });
                }
            });

            if (recommendedPlaces.length === 0) {
                // If no matches, recommend random quiet places
                recommendedPlaces = placesData.filter(p => p.congestion === 'quiet').slice(0, 3);
                addChatMessage(
                    `"${message}"ì— ëŒ€í•œ ì •í™•í•œ ê²°ê³¼ëŠ” ì°¾ê¸° ì–´ë µì§€ë§Œ, í•œì í•˜ê³  ì¢‹ì€ ì¥ì†Œë“¤ì„ ì¶”ì²œí•´ë“œë¦´ê²Œìš”! ğŸŒ¿`,
                    'ai'
                );
            } else {
                recommendedPlaces.sort((a, b) => b.score - a.score);
                recommendedPlaces = recommendedPlaces.slice(0, 4);
                addChatMessage(
                    `"${message}"ì— ë”± ë§ëŠ” ì¥ì†Œë“¤ì„ ì°¾ì•˜ì–´ìš”! ì•„ë˜ì—ì„œ í™•ì¸í•´ë³´ì„¸ìš” âœ¨`,
                    'ai'
                );
            }

            showResults(recommendedPlaces, 'ë‹¹ì‹ ì˜ ìš”ì²­ì„ ë¶„ì„í–ˆì–´ìš”');
        }

        function showResults(places, subtitle) {
            const resultsSection = document.getElementById('results-section');
            const resultsGrid = document.getElementById('results-grid');
            const resultsSubtitle = document.getElementById('results-subtitle');

            resultsSubtitle.textContent = subtitle;

            resultsGrid.innerHTML = places.map(place => `
        <div class="recommended-card">
          <div class="recommended-card__image">
            <img src="${place.images[0]}" alt="${place.name}">
          </div>
          <div class="recommended-card__content">
            <h3 class="recommended-card__title">${place.name}</h3>
            <p class="recommended-card__reason">${place.shortDesc}</p>
            <div class="recommended-card__actions">
              <a href="detail.html?id=${place.id}" class="btn btn-secondary btn-sm">ìì„¸íˆ ë³´ê¸°</a>
              <button class="btn btn-primary btn-sm" onclick="addToPlan(${place.id})">
                + ì¼ì • ì¶”ê°€
              </button>
            </div>
          </div>
        </div>
      `).join('');

            resultsSection.style.display = 'block';
            resultsSection.scrollIntoView({ behavior: 'smooth', block: 'start' });

            // Store recommended places
            window.recommendedPlaces = places;
        }

        function addToPlan(placeId) {
            let saved = JSON.parse(localStorage.getItem('teumsae_saved') || '[]');
            if (!saved.includes(placeId)) {
                saved.push(placeId);
                localStorage.setItem('teumsae_saved', JSON.stringify(saved));
                showToast('ì¼ì •ì— ì¶”ê°€í–ˆìŠµë‹ˆë‹¤!');
            } else {
                showToast('ì´ë¯¸ ì¶”ê°€ëœ ì¥ì†Œì…ë‹ˆë‹¤.');
            }
        }

        function addAllToPlan() {
            if (!window.recommendedPlaces) return;

            let saved = JSON.parse(localStorage.getItem('teumsae_saved') || '[]');
            let added = 0;

            window.recommendedPlaces.forEach(place => {
                if (!saved.includes(place.id)) {
                    saved.push(place.id);
                    added++;
                }
            });

            localStorage.setItem('teumsae_saved', JSON.stringify(saved));
            showToast(`${added}ê°œ ì¥ì†Œë¥¼ ì¼ì •ì— ì¶”ê°€í–ˆìŠµë‹ˆë‹¤!`);
        }

        function showToast(message) {
            const existing = document.querySelector('.toast');
            if (existing) existing.remove();

            const toast = document.createElement('div');
            toast.className = 'toast';
            toast.innerHTML = message;
            toast.style.cssText = `
        position: fixed;
        bottom: 2rem;
        left: 50%;
        transform: translateX(-50%) translateY(100px);
        background: var(--color-dark);
        color: var(--color-white);
        padding: 1rem 2rem;
        border-radius: 50px;
        font-size: 0.875rem;
        z-index: 1000;
        transition: transform 0.3s ease;
      `;

            document.body.appendChild(toast);

            setTimeout(() => {
                toast.style.transform = 'translateX(-50%) translateY(0)';
            }, 10);

            setTimeout(() => {
                toast.style.transform = 'translateX(-50%) translateY(100px)';
                setTimeout(() => toast.remove(), 300);
            }, 2500);
        }

        // Reveal animations
        document.querySelectorAll('.reveal').forEach(el => {
            setTimeout(() => el.classList.add('revealed'), 100);
        });
    </script>
</body>


</html>



